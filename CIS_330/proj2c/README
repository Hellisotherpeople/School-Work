I believe that this code is correct. I ran diff with it and it found no differences, and I have manually confirmed this to be true. 